{% extends "content/internal/base_internal.html" %}

{% block title %}
  {% if mode == "archive" %}
    –ê—Ä—Ö–∏–≤ —Å—Ç–∞—Ç–µ–π
  {% else %}
    –ü–∞–Ω–µ–ª—å –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä–∞
  {% endif %}
{% endblock %}

{% block content %}

<div class="dashboard-header">
  <h1>
    {% if mode == "archive" %}
      –ê—Ä—Ö–∏–≤ —Å—Ç–∞—Ç–µ–π
    {% else %}
      –ü–∞–Ω–µ–ª—å –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä–∞
    {% endif %}
  </h1>

  <div class="dashboard-actions">
    <a href="{% url 'section_list' %}" class="btn btn-secondary">
      –†–µ–¥–∞–∫—Ç–æ—Ä —Ä–∞–∑–¥–µ–ª–æ–≤
    </a>

    <a href="{% url 'create_post' %}" class="btn btn-primary">
      ‚ûï –ù–æ–≤–∞—è —Å—Ç–∞—Ç—å—è
    </a>

    {% if mode != "archive" %}
      <a href="{% url 'archived_posts' %}" class="btn btn-secondary">
        üóÑ –ê—Ä—Ö–∏–≤
      </a>
    {% else %}
      <a href="{% url 'dashboard' %}" class="btn btn-secondary">
        ‚Üê –ö –∞–∫—Ç–∏–≤–Ω—ã–º
      </a>
    {% endif %}
  </div>
</div>

<div class="dashboard-card">

<table class="dashboard-table">
  <thead>
    <tr>
      <th>–°—Ç–∞—Ç—å—è</th>
      <th>–°—Ç–∞—Ç—É—Å</th>
      <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
  </thead>

  <tbody>
  {% for post in page_obj %}
    <tr>

      {# === –ó–ê–ì–û–õ–û–í–û–ö + –†–ê–ó–î–ï–õ (–í –û–î–ù–û–ô –ö–û–õ–û–ù–ö–ï) === #}
      <td class="col-title">
        <div class="post-title">
          {{ post.title }}
        </div>
        <div class="post-section">
          {{ post.section.title }}
        </div>
      </td>

      {# === –°–¢–ê–¢–£–° === #}
      <td class="col-status">
        <span class="status status-{{ post.status }}">
          {{ post.get_status_display }}
        </span>
      </td>

      {# === –î–ï–ô–°–¢–í–ò–Ø === #}
      <td class="col-actions">
        <div class="actions-group">

          <a href="{% url 'post_detail' post.slug %}"
           class="action-btn action-view"
           title="–ü—Ä–æ—Å–º–æ—Ç—Ä">üëÅ</a>

          <a href="{% url 'edit_post' post.slug %}"
           class="action-btn action-edit"
           title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>

         {% if post.status != post.Status.PUBLISHED %}
          <form action="{% url 'publish_post' post.slug %}" method="post">
            {% csrf_token %}
            <button type="submit"
                    class="action-btn action-publish"
                    title="–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å">üìå</button>
          </form>
          {% endif %}

          {% if post.status != post.Status.ARCHIVED and mode != "archive" %}
          <form action="{% url 'archive_post' post.slug %}" method="post">
            {% csrf_token %}
            <button type="submit"
                    class="action-btn action-archive"
                    title="–í –∞—Ä—Ö–∏–≤">üóÑ</button>
          </form>
          {% endif %}

        <form action="{% url 'delete_post' post.slug %}"
              method="post"
              onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é –Ω–∞–≤—Å–µ–≥–¥–∞?');">
          {% csrf_token %}
          <button type="submit"
                  class="action-btn action-delete"
                  title="–£–¥–∞–ª–∏—Ç—å">üóë</button>
        </form>

        </div>
      </td>

    </tr>

  {% empty %}
    <tr>
      <td colspan="3">–°—Ç–∞—Ç–µ–π –Ω–µ—Ç</td>
    </tr>
  {% endfor %}
  </tbody>
</table>

</div>

{% if page_obj and page_obj.has_other_pages %}
  <nav class="pagination">

    {% if page_obj.has_previous %}
      <a class="page-nav"
         href="?page={{ page_obj.previous_page_number }}">
        ‚Üê
      </a>
    {% endif %}

    {% for num in page_obj.paginator.page_range %}
      {% if num == page_obj.number %}
        <span class="page-number active">{{ num }}</span>
      {% elif num > page_obj.number|add:"-3" and num < page_obj.number|add:"3" %}
        <a class="page-number"
           href="?page={{ num }}">
          {{ num }}
        </a>
      {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
      <a class="page-nav"
         href="?page={{ page_obj.next_page_number }}">
        ‚Üí
      </a>
    {% endif %}

  </nav>
{% endif %}


{% endblock %}
